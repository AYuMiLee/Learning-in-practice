# 源码剖析

Netty中的 ChannelPipeline、ChannelHandler 和 ChannelHandlerContext 是非常核心的组件，我们从源码来分析Netty 是如何设计这三个核心组件的，并分析是如何创建和协调工作的。

### ChannelPipeline、ChannelHandler、ChannelHandlerContext 介绍

1)每当 ServerSocket 创建一个新的连接，就会创建一个 Socket，对应的就是目标客户端。

2)每一个新创建的 Socket，都将会分配一个全新的 ChannelPipeline（以下简称 pipeline）

3)每一个 ChannelPipeline 内部都含有多个 ChannelHandlerContext(以下简称 Context)

4)**他们一起组成了双向链表**，这些Context 用于包装我们调用 addLast方法时添加的 ChannelHandler(以下简称handler )

![](images/27.三者关系示意图.jpg)

- 上图中：ChannelSocket 和  ChannePipeline 是一对一的关联关系，而 pipeline 内部的多个 Context 形成了链表，**Context只是对Handler的封装**
- 当一个请求进来的时候，会进入 Socket 对应的 pipeline，并经过 pipeine 所有的 handle，这就是设计模式中的过滤器模式(一般和责任链模式一起)。

### ChannelPipeLine 作用及设计











